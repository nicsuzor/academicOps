---
title: Generated Indices
type: spec
category: spec
status: draft
permalink: specs/generated-indices
tags: [framework, architecture, audit]
---

# Generated Indices

## What They Are

Generated indices are root-level markdown files designed for direct agent consumption. They distill information from across the framework into concise, structured formats that agents can read to make decisions.

**Key properties:**
- **Derived**: Computed from source files (skills, hooks, agents, specs)
- **Deterministic**: Same inputs produce same outputs
- **Agent-optimized**: Structured for quick lookup, not human narrative
- **Not manually edited**: Changes flow from source → audit → index

## The Category

| File | Purpose | Derived From |
|------|---------|--------------|
| `INDEX.md` | File tree and locations | Directory structure |
| `RULES.md` | Enforcement mechanisms | Hooks, settings.json, pre-commit |
| `WORKFLOWS.md` | Task classification and routing | Skills, agents, guardrails |
| `docs/ENFORCEMENT.md` | Practical enforcement guide + root cause analysis | specs/enforcement.md, observed patterns |

## Flow

```
Source files (skills/, agents/, hooks/, specs/)
    ↓
Audit skill reads sources, computes indices
    ↓
Generated indices (INDEX.md, RULES.md, WORKFLOWS.md, docs/ENFORCEMENT.md)
    ↓
Agents read indices for decisions
```

## Why This Pattern

**Problem**: Agents need quick answers ("what workflow for this task?", "where do files go?", "what rules apply?"). Searching across dozens of source files is slow and error-prone.

**Solution**: Precompute the answers into structured indices. Agents read one file instead of many.

**Constraint**: Indices must stay in sync with sources. Manual editing breaks this. Audit skill regenerates indices from current state.

## WORKFLOWS.md

Derives task types and routing from:
- **Skill definitions**: Each skill serves certain task types
- **Agent definitions**: Each agent handles certain workflows
- **Guardrails**: Type → guardrail mappings

The audit skill reads these sources and synthesizes:
- Task types with descriptions of when each applies
- Workflow for each type (plan-mode, tdd, verify-first, etc.)
- Planning skill for each type

**Example derivation logic:**
- Skill `framework` handles framework changes → task type `framework`
- Skill `python-dev` uses TDD → task type `python`, workflow `tdd`
- Agent `hypervisor` uses plan-mode for complex work → workflow `plan-mode`

## INDEX.md

Derives file tree from:
- Directory structure (`ls -R`)
- File purposes from frontmatter/headers
- Category assignments

## RULES.md

Derives enforcement from:
- `hooks/*.py` - what each hook enforces
- `config/claude/settings.json` - deny rules
- `.pre-commit-config.yaml` - commit-time checks

## Audit Skill Responsibility

The `/audit` skill (or a dedicated regeneration command) must:

1. **Read sources**: Scan skills/, agents/, hooks/, specs/
2. **Extract metadata**: Frontmatter, descriptions, relationships
3. **Compute indices**: Generate structured tables
4. **Write indices**: Overwrite INDEX.md, RULES.md, WORKFLOWS.md
5. **Verify consistency**: Flag if sources have conflicts

**Trigger**: Run audit after any structural change to framework.

## Acceptance Criteria

1. Generated indices live at root level or docs/ (not in config/ or generated/)
2. Each index declares "Generated by audit skill - do not edit manually"
3. Audit skill can regenerate all indices from current state
4. Agents reference indices, not scattered source files
5. Manual edits to indices are overwritten on next audit run
6. docs/ENFORCEMENT.md includes Root Cause Analysis section derived from specs/enforcement.md

## Migration

Current state:
- `INDEX.md` exists (manually maintained)
- `RULES.md` exists (manually maintained)
- `WORKFLOWS.md` exists (generated)
- `docs/ENFORCEMENT.md` exists (manually maintained, needs generation)

Target state:
- Add "Generated by audit" header to all four
- Update audit skill to regenerate all indices
- docs/ENFORCEMENT.md regenerated with Root Cause Analysis from specs/enforcement.md
